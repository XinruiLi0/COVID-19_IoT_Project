@*
    ViewData["Title"] = "GuardList";
*@

<script type="text/javascript">
    window.onload = function() {
        var userem = getCookie("userEmail");
        var username = getCookie("username");
        var userpass = getCookie("userPassword");
        var userrol = getCookie("userRole");
        $("#wel").html("Welcome the Guard User: " + userem);
        $("#thx").html("Dear " + username + " Thank you for your effort to keep everynody healthy!");
        $.ajax({
            type: "POST",
            dataType: "text",
            url: "/Home/getGuardDevices",
            data: { "userEmail": userem, "userPassword": userpass },
            success: function (data) {
                showList(data);
            },
            error: function (xhr, ts, et) {
                alert("Error");
            }
        });
    }
    
    function getCookie(c_name) {
        if (document.cookie.length > 0) {
            c_start = document.cookie.indexOf(c_name + "=");
            if (c_start != -1) {
                c_start = c_start + c_name.length + 1;
                c_end = document.cookie.indexOf(";", c_start);
                if (c_end == -1) {
                    c_end = document.cookie.length;
                }
                return unescape(document.cookie.substring(c_start, c_end));
            }
        }
        return "";
    }

    function showList(data) {
        var table = document.getElementById("list");
        var obj = JSON.parse(data);
        //alert(obj[0]); json数字开头

        for (var i = 0; i < Object.keys(obj).length; i++) {
            var id = obj[i].DeviceID;
            var des = obj[i].Description;
            var row = table.insertRow(i+1);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            cell1.innerHTML = i+1;
            cell2.innerHTML = id;
            cell3.innerHTML = des;
        }
    }

</script>

<h1 id="wel"> </h1>
<h5 id="thx"> </h5>
<div class="col-lg-3 col-mid-3 col-sm-3 col-xs-3 " style="position:relative;">
    <img class="img-responsive" src="~/guard.png" alt="users" style="width:100%; height:100%">
</div>

<table id="list" class="table">
    <thead class="thead-light">
        <tr>
            <th>No of Device</th>
            <th>Device ID</th>
            <th>Description</th>
            <th>Device Link</th>
        </tr>
    </thead>
</table>